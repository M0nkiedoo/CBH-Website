<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CBH Theory</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- Flicker overlay -->
  <div class="flicker-overlay"></div>

  <!-- Hero section with title -->
  <div class="hero" id="hero">
    <a href="theory.html" class="title-link" onclick="flashBackground()">CBH Theory</a>
    
    <!-- Optional lightning bolt -->
    <svg class="bolt" viewBox="0 0 100 100">
      <polyline points="40,0 60,40 45,40 60,100 35,60 50,60 40,0"
                fill="none" stroke="white" stroke-width="3" />
    </svg>
  </div>

  <!-- Audio for interaction -->
  <audio id="click-sound" src="sounds/click.mp3" preload="auto"></audio>
  <audio id="zap-sound" src="sounds/arc-zap.mp3" preload="auto"></audio>

  <!-- Interaction scripts -->
  <script>
    function flashBackground() {
      const hero = document.getElementById('hero');
      hero.classList.add('flash');

      const clickSound = document.getElementById('click-sound');
      const zapSound = document.getElementById('zap-sound');
      if (clickSound) {
        clickSound.currentTime = 0;
        clickSound.play();
      }
      if (zapSound) {
        zapSound.currentTime = 0;
        zapSound.play();
      }

      setTimeout(() => {
        hero.classList.remove('flash');
      }, 1500);
    }

    document.querySelector('.title-link').addEventListener('mouseenter', () => {
      const zapSound = document.getElementById('zap-sound');
      if (zapSound) {
        zapSound.currentTime = 0;
        zapSound.play();
      }
    });

  window.addEventListener('load', () => {
    const context = new (window.AudioContext || window.webkitAudioContext)();

    // Create base hum oscillator
    const osc = context.createOscillator();
    osc.type = 'sine'; // you can also try 'triangle' or 'sawtooth'
    osc.frequency.value = 58; // low-end frequency, feels physical

    // Create gain for volume control
    const gain = context.createGain();
    gain.gain.value = 0.015; // very soft hum

    // Connect and start
    osc.connect(gain).connect(context.destination);
    osc.start();

    // Add subtle modulation (like a slight unstable ripple)
    const lfo = context.createOscillator();
    const lfoGain = context.createGain();

    lfo.type = 'sine';
    lfo.frequency.value = 0.3; // slow pulsation
    lfoGain.gain.value = 0.005; // slight amplitude modulation

    lfo.connect(lfoGain).connect(gain.gain);
    lfo.start();

    // Ensure sound starts even if autoplay is blocked
    document.body.addEventListener('click', () => {
      context.resume();
    }, { once: true });
  });
</script>
</body>
</html>
